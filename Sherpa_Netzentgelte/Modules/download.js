function sherpa_download_strom(request,response) {	var result = '';      var abfrage = ds.Einstellungen.all().first(); 	result = csv('PLZ') + csv('Netzbetreiber') + csv('BDEW-Code') + csv('gültig von') + csv('gültig bis')  + csv('Arbeit HT') +csv ('Arbeit NT')+ csv('Leistung') + csv('Blindmehrarbeit')+csv('Spg. Entnahme') + csv('Spg. Messung') + csv('Zählerart')+csv('Entgelttyp');    result += csv('Gesamtpreis') + csv('Abrechnugspreis') + csv('MSB') + csv('MDL') + csv('Ablesung') + csv('Grundpreis') + csv('Arbeitspreis') + csv('Arbeitspreis HT') + csv('Arbeitspreis NT') + csv('Leistungspreis')    result += csv ('Blindmehrarbeit')+csv ('Datenbereitstellung')+csv('KA')+csv('KA Tarif')+csv ('KA SVK')+csv ('KA Schwachlast')+csv ('Wandler enth.');    result += csv ('KWKG')+csv ('Offshore')+csv ('§ 19 NEV');    result +=  '\n';        var ergebnis_strom = ds.Auswertung_Strom.all();         	  ergebnis_strom.forEach(function(mitem) {        result += csv(mitem.plz) + csv(mitem.netzbetreibername) + csv(mitem.bdew);        result += csv(dateTostring(mitem.gueltig_von)) + csv(dateTostring(mitem.gueltig_bis));        result += csv(abfrage.arbeit_HT)+csv(abfrage.arbeit_NT) + csv(abfrage.leistung_strom)+csv(abfrage.blind);        result += csv(abfrage.spe_entnahme)+csv(abfrage.spe_messung)+csv(abfrage.zaehlerart)+csv(abfrage.entgelttyp);               result += csv(mitem.gesamtpreis) + csv(mitem.abrechnung) + csv(mitem.msb) + csv(mitem.mdl) + csv(mitem.ablesung) + csv(mitem.grundpreis) + csv(mitem.wirkarbeit) + csv(mitem.wirkarbeit_HT) + csv(mitem.wirkarbeit_NT)+csv(mitem.leistung);     	result += csv (mitem.blindmehrarbeit)+csv (mitem.datenbereitstellung)+csv (mitem.konzessionsabgabe)+csv (mitem.ka_tarif)+csv (mitem.ka_svk)+csv (mitem.ka_schwachlast)     	if (mitem.stromWandlerEnthalten) {     		result += csv ('Ja')     		} else {     		result += csv ('Nein');     		};     		     	result += csv (mitem.kwk)+csv(mitem.offshore)+csv(mitem.sonderkundenaufschlag);     	     	        result += '\n';    });     	response.headers['Content-type'] = 'text/csv; charset=ISO-8859-1';    response.headers['Content-Disposition'] = 'attachment; filename="Report-Strom.csv"'; // Set value     response.sendChunkedData(result);	};function sherpa_download_gas(request, response) {     var result = '';       var abfrage = ds.Einstellungen.all().first(); 	result = csv('PLZ') + csv('Netzbetreiber') + csv('BDEW-Code') + csv('gültig von') + csv('gültig bis') + csv('Druckstufe') + csv('Arbeit') + csv('Leistung') + csv('RLM/SLP') + csv('Leistungspreis') + csv('Arbeitspreis');    result += csv('Grundpreis') + csv('Abrechnugspreis') + csv('MSB') + csv('MDL') + csv('Regelenergieumlage') + csv('KA') + csv('Gesampreis') + csv('Zählergröße von') + csv('Zählergröße bis') + csv('Zählertyp') + '\n';        var ergebnis_gas = ds.Auswertung_Gas.all();         	  ergebnis_gas.forEach(function(mitem) {        result += csv(mitem.plz) + csv(mitem.netzbetreibername) + csv(mitem.bdew);        result += csv(dateTostring(mitem.gueltig_von)) + csv(dateTostring(mitem.gueltig_bis));        result += csv(mitem.druckstufe);        result += csv(abfrage.arbeit) + csv(abfrage.leistung);        if (mitem.mitLeistungsmessung) {            result += csv('RLM');        }        else {            result += csv('SLP');        };        result += csv(mitem.leistung) + csv(mitem.wirkarbeit) + csv(mitem.grundpreis) + csv(mitem.abrechnung) + csv(mitem.msb) + csv(mitem.mdl) + csv(mitem.regelenergieumlage) + csv(mitem.konzessionsabgabe) + csv(mitem.gesamtpreis);        result += csv(mitem.zaehlergroesse_von) + csv(mitem.zaehlergroesse_bis) + csv(mitem.zaehlertyp);        result += '\n';    });       	response.headers['Content-type'] = 'text/csv; charset=ISO-8859-1';    response.headers['Content-Disposition'] = 'attachment; filename="Report-Gas.csv"'; // Set value     response.sendChunkedData(result);       };function csv (my_item) {		if (typeof(my_item) === 'number') {		my_item =my_item.toLocaleString();		my_item = my_item.replace('.',',');	};				my_item = my_item.replace('"','""')	return '"'+my_item+'";';};function dateTostring (my_date) {		var tag = my_date.getDate().toString();	if (tag.length === 1) { tag ='0'+tag};	var monat = (my_date.getMonth()+1).toString();	if (monat.length === 1) {monat ='0'+monat};	var jahr =my_date.getFullYear().toString();		return tag+"."+monat+"."+jahr;	};